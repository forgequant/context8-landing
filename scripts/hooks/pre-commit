#!/usr/bin/env sh
# context8-landing pre-commit hook: prek checks + beads sync
# Versioned in scripts/hooks/, installed via task hooks:install

set -e

# 1. Run prek pre-commit checks (contract lint, typecheck, lint, test)
if command -v uvx >/dev/null 2>&1; then
    echo "â–¶ prek: running pre-commit checks..."
    uvx prek run --hook-stage pre-commit
else
    echo "Warning: uvx not found, skipping prek checks" >&2
fi

# 2. Run beads sync (flush pending changes to JSONL)
if command -v bd >/dev/null 2>&1; then
    bd hooks run pre-commit "$@"
else
    echo "Warning: bd not found, skipping beads sync" >&2
fi
